(this.webpackJsonpspotify_clone=this.webpackJsonpspotify_clone||[]).push([[0],{100:function(e,t,n){},150:function(e,t,n){},153:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(18),i=n.n(r),s=(n(100),n(83)),o=n(8),l=n(9),u=n(47),d=n(19),b=n.n(d),j="https://test-musicloud.herokuapp.com";function h(e){var t=Object(c.useState)(),n=Object(l.a)(t,2),a=n[0],r=n[1],i=Object(c.useState)(),s=Object(l.a)(i,2),o=s[0],u=s[1],d=Object(c.useState)(),h=Object(l.a)(d,2),p=h[0],f=h[1];return Object(c.useEffect)((function(){b.a.post("".concat(j,"/login"),{code:e}).then((function(e){r(e.data.accessToken),u(e.data.refreshToken),f(e.data.expiresIn),window.history.pushState({},null,"/")})).catch((function(e){console.log(e),window.location="/"}))}),[e]),Object(c.useEffect)((function(){!function(){if(o&&p){var e=setInterval((function(){b.a.post("".concat(j,"/refresh"),{refreshToken:o}).then((function(e){r(e.data.accessToken),f(e.data.expiresIn)})).catch((function(){window.location="/"}))}),1e3*(p-60))}}()}),[o,p]),a}console.log("BACKEND: ",j);var p=n(27),f=n.n(p),m=n(49),O=n(177),g=n(178),x=n(175),v=n(187),w=n(176),y=n(12),k=n(78),S=n.n(k),T=(n(56),n(2)),I=function(e){var t=e.track,n=e.chooseTrack,c=e.input;return Object(T.jsxs)("div",{id:"track",style:{cursor:"pointer",display:"flex",margin:"1rem",alignItems:"center"},onClick:function(){n(t),c.style.display="none"},children:[Object(T.jsx)("img",{src:t.albumUrl,style:{height:"64px",width:"64px"}}),Object(T.jsxs)("div",{style:{marginLeft:"1.2rem"},children:[Object(T.jsxs)(x.a,{variant:"subtitle1",children:[" ",Object(T.jsx)("strong",{children:t.title})," "]}),Object(T.jsx)(x.a,{variant:"body2",children:t.artist[0].name})]})]})},E=Object(w.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:Object(m.a)({flexGrow:1,display:"none"},e.breakpoints.up("sm"),{display:"block"}),search:Object(m.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(y.b)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(y.b)(e.palette.common.white,.25)},marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(1),width:"auto"}),searchIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:Object(m.a)({padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("sm"),{width:"12ch","&:focus":{width:"20ch"}})}})),N=function(e){var t=e.search,n=e.setSearch,c=e.result,a=(e.setResult,e.setPlayingTrack,e.chooseTrack),r=E(),i=document.getElementById("searchWindow");return Object(T.jsxs)("div",{className:r.root,children:[Object(T.jsx)(O.a,{position:"fixed",children:Object(T.jsxs)(g.a,{children:[Object(T.jsx)(x.a,{className:r.title,variant:"h5",noWrap:!0,children:"MUSI-CLOUD"}),Object(T.jsxs)("div",{className:r.search,children:[Object(T.jsx)("div",{className:r.searchIcon,children:Object(T.jsx)(S.a,{})}),Object(T.jsx)(v.a,{placeholder:"Search\u2026",classes:{root:r.inputRoot,input:r.inputInput},inputProps:{"aria-label":"search"},onChange:function(e){n(e.target.value),""!=e.target.value&&t?i.style.display="block":i.style.display="none"},value:t})]})]})}),Object(T.jsx)("div",{id:"searchWindow",children:c?c.map((function(e){return Object(T.jsx)(I,{track:e,chooseTrack:a,input:i},e.uri)})):"Nothing here"})]})},L=n(79),C=n(179),U=n(181),B=n(180),D=n(182),P=n(80),_=n.n(P),A=n(81),R=n.n(A),M=n(82),z=n.n(M),F=n(186),J=new f.a({clientId:"259736e82b7345488052a954c68c9cbc"}),G=function(e,t,n){var c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(J.setAccessToken(e),!t)return n([]);if(e){var a=!1;J.searchTracks(t).then((function(e){a||n(e.body.tracks.items.map((function(e){var t=e.album.images.reduce((function(e,t){if(c){if(t.height>e.height)return t}else if(t.height<e.height)return t;return e}),e.album.images[0]);return{artist:e.artists,title:e.name,uri:e.uri,albumUrl:t.url,externalUrl:e.external_urls.spotify}})))}))}},H=Object(w.a)((function(e){return{root:{display:"flex",background:"#cae6e8"},details:{display:"flex",flexDirection:"column"},content:{flex:"1 0 auto"},cover:{width:"10rem",height:"inherit"},controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingBottom:e.spacing(1)},playIcon:{height:38,width:38}}})),K=new f.a({clientId:"259736e82b7345488052a954c68c9cbc"}),W=parseInt("20"),Y=function(e){e.index;var t=e.accessToken,n=e.track,a=e.speed,r=e.setPlayingTrack,i=H(),s=(Object(L.a)(),Object(c.useState)([{artist:[{name:"Artist Name"}],title:"Song name",albumUrl:"https://www.thefennvoice.org/.a/6a017d3e8f0065970c022ad3c481a6200d-pi"}])),o=Object(l.a)(s,2),u=o[0],d=o[1];return Object(c.useEffect)((function(){t&&(K.setAccessToken(t),function(e){var n=e.Key._text;n=a<W?n.substr(0,n.length-8):n.substr(0,n.length-4),G(t,n,d,!0)}(n))}),[t]),Object(T.jsx)("div",{style:{margin:"1rem auto",width:"90%"},children:Object(T.jsxs)(C.a,{className:i.root,children:[Object(T.jsx)(B.a,{className:i.cover,image:u[0]?u[0].albumUrl:"Image",title:"Live from space album cover"}),Object(T.jsxs)("div",{className:i.details,children:[Object(T.jsxs)(U.a,{className:i.content,children:[Object(T.jsx)(x.a,{component:"div",variant:"h6",style:{width:"200px",whiteSpace:"nowrap"},children:Object(T.jsx)(F.a,{component:"div",textOverflow:"ellipsis",overflow:"hidden",children:Object(T.jsx)("strong",{children:u[0]?u[0].title:"SONG NAME"})})}),Object(T.jsx)(x.a,{variant:"subtitle2",color:"textSecondary",children:u[0]?u[0].artist[0].name:"Artist"})]}),Object(T.jsxs)("div",{className:i.controls,children:[Object(T.jsx)(D.a,{"aria-label":"previous",children:Object(T.jsx)(_.a,{})}),Object(T.jsx)("a",{onClick:function(){return e=u[0],void r(e);var e},children:Object(T.jsx)(D.a,{"aria-label":"play/pause",children:Object(T.jsx)(R.a,{className:i.playIcon})})}),Object(T.jsx)(D.a,{"aria-label":"next",children:Object(T.jsx)(z.a,{})})]})]})]})})},q=function(e){var t=e.accessToken,n=e.result,c=e.speed,a=e.setPlayingTrack,r=e.setUrlName;return Object(T.jsxs)("div",{style:{width:"80%",margin:"1rem auto"},children:[Object(T.jsx)(x.a,{variant:"h3",component:"h4",children:"Library"}),Object(T.jsx)("div",{className:"homegrid",children:n.map((function(e,n){return Object(T.jsx)(Y,{accessToken:t,track:e,speed:c,setPlayingTrack:a,setUrlName:r},n)}))})]})},Q=n(183),V=n(26),X=n.n(V),Z=n(50),$="https://test-musicloud.herokuapp.com",ee=parseInt("20"),te=function(){var e=Object(Z.a)(X.a.mark((function e(t,n,c){var a,r;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="testmusicdata",a=t>ee?"testmusicdata":"testmusicdata-lowrate",n.forEach((function(e){e.includes(c.title)&&(r=e.replaceAll(" ","%20"))})),!r){e.next=5;break}return e.abrupt("return","https://".concat(a,".s3.us-south.cloud-object-storage.appdomain.cloud/").concat(r));case 5:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),ne=function(){var e=Object(Z.a)(X.a.mark((function e(t,n){var c;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("".concat($,"/download"),{params:{uri:t.externalUrl,title:t.title,artist:t.artist[0].name}}).then((function(e){return console.log("DONE"),{name:e.data.name,dest:e.data.dest}}));case 2:return c=e.sent,e.abrupt("return",{name:c.name,dest:c.dest});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ce=function(){var e=Object(Z.a)(X.a.mark((function e(t,n,c){var a;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("".concat($,"/upload"),{params:{name:t,dest:n,internetSpeed:c}}).then((function(e){return e.data}));case 2:return a=e.sent,e.abrupt("return",{data:a});case 4:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),ae=(n(150),function(e){var t=e.track,n=e.url,a=Object(c.useState)(n),r=Object(l.a)(a,2),i=r[0],s=r[1];return Object(c.useEffect)((function(){s(n)}),[n,t]),Object(T.jsxs)("div",{id:"container",children:[Object(T.jsx)("img",{src:t.albumUrl,width:"100",height:"100",alt:"",id:"img"}),Object(T.jsx)("h1",{className:"title",children:t?t.title:"Song Name"}),Object(T.jsx)("audio",{controls:!0,style:{width:"95%",marginLeft:"-4rem"},autoPlay:!0,src:i,type:"audio/mpeg"})]})}),re=function(e){var t=e.track,n=e.speed,a=Object(c.useState)(""),r=Object(l.a)(a,2),i=r[0],s=r[1],o=Object(c.useState)([]),d=Object(l.a)(o,2),j=d[0],h=d[1],p=function(){b.a.get("".concat("https://test-musicloud.herokuapp.com","/list"),{params:{internetSpeed:n}}).then((function(e){JSON.parse(e.data).ListBucketResult.Contents.forEach((function(e){h((function(t){return[].concat(Object(u.a)(t),[e.Key._text])}))}))}))},f=function(){te(n,j,t).then((function(e){return s(e)}))};return Object(c.useEffect)((function(){p(),f()}),[]),Object(c.useEffect)((function(){p(),f()}),[t]),Object(T.jsx)("div",{children:i?Object(T.jsx)("div",{style:{width:"100%",position:"fixed",bottom:0,background:"linear-gradient(90deg, rgba(157,89,203,1) 0%, rgba(255,104,104,1) 50%, rgba(233,180,105,1) 100%)",padding:"1rem 2rem",textAlign:"center"},children:Object(T.jsx)(ae,{track:t,url:i})}):Object(T.jsxs)("div",{style:{width:"100%",position:"fixed",bottom:0,paddingBottom:"1rem",textAlign:"center",background:"linear-gradient(90deg, rgba(157,89,203,1) 0%, rgba(255,104,104,1) 50%, rgba(233,180,105,1) 100%)"},children:[Object(T.jsx)("h2",{children:"Song Not found in Library"}),Object(T.jsx)(Q.a,{color:"primary",id:"btn",variant:"contained",onClick:function(){var e=document.getElementById("btn");e.innerHTML="Downloading...",ne(t,n).then((function(t){e.innerHTML="Uploading...",console.log(t),ce(t.name,t.dest,n).then((function(t){e.innerHTML="Upload Successful",console.log(t.data)}))}))},children:"Download"})]})})},ie=n(188),se=n(184),oe=Object(w.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}})),le=function(){var e=oe(),t=Object(c.useState)(!1),n=Object(l.a)(t,2),a=n[0],r=n[1];return Object(c.useEffect)((function(){r(!a)}),[]),Object(T.jsx)("div",{children:Object(T.jsx)(ie.a,{className:e.backdrop,open:a,children:Object(T.jsx)(se.a,{color:"secondary"})})})},ue=new f.a({clientId:"259736e82b7345488052a954c68c9cbc"}),de=function(e){var t=e.code,n=e.speed,a=h(t),r=Object(c.useState)(),i=Object(l.a)(r,2),s=i[0],o=i[1],d=Object(c.useState)([]),j=Object(l.a)(d,2),p=j[0],f=j[1],m=Object(c.useState)([]),O=Object(l.a)(m,2),g=O[0],x=O[1],v=Object(c.useState)(),w=Object(l.a)(v,2),y=w[0],k=w[1];return Object(c.useEffect)((function(){n&&(console.log("Your Internet SPEED is: ",n),b.a.get("".concat("https://test-musicloud.herokuapp.com","/list"),{params:{internetSpeed:n}}).then((function(e){return JSON.parse(e.data)})).then((function(e){e.ListBucketResult.Contents.forEach((function(e){f((function(t){return[].concat(Object(u.a)(t),[e])}))}))})))}),[n]),Object(c.useEffect)((function(){a&&ue.setAccessToken(a)}),[a]),Object(c.useEffect)((function(){G(a,s,x)}),[a,s]),Object(T.jsxs)("div",{children:[Object(T.jsx)(N,{search:s,setSearch:o,result:g,setResult:x,setPlayingTrack:k,chooseTrack:function(e){o(""),k(e),x([])}}),Object(T.jsx)("div",{style:{marginTop:"5rem"}}),0==p.length&&Object(T.jsx)("div",{children:Object(T.jsx)(le,{})}),0!==p.length&&Object(T.jsxs)("div",{children:[Object(T.jsx)(q,{result:p,accessToken:a,speed:n,setPlayingTrack:k}),Object(T.jsx)("div",{style:{marginBottom:"10rem"}}),y&&Object(T.jsx)(re,{track:y,speed:n})]})]})},be="https://accounts.spotify.com/authorize?client_id=".concat("259736e82b7345488052a954c68c9cbc","&response_type=code&redirect_uri=").concat("https://test-musicloud.herokuapp.com/","&scope=").concat("streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state"),je=function(){return Object(T.jsx)("div",{style:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#ebebeb"},children:Object(T.jsx)("a",{href:be,style:{textDecoration:"none"},children:Object(T.jsx)(Q.a,{color:"secondary",variant:"contained",size:"large",children:"Login to MUSICLOUD"})})})},he=n(84),pe=n(185),fe=Object(he.a)({palette:{primary:{light:"#339ba5",main:"#00838f",dark:"#005b64",contrastText:"#fff"},secondary:{light:"#df6843",main:"#d84315",dark:"#972e0e",contrastText:"#fff"}}}),me=new URLSearchParams(window.location.search).get("code");var Oe=function(){var e=Object(c.useState)(0),t=Object(l.a)(e,2),n=t[0],a=t[1];return Object(T.jsxs)(pe.a,{theme:fe,children:[function(){function e(){console.log("Checking your network speed, please wait..."),window.setTimeout(t,1)}function t(){var e,t,n=new Image;n.onload=function(){t=(new Date).getTime(),function(){var n=(((8388608/((t-e)/1e3)).toFixed(2)/1024).toFixed(2)/1024).toFixed(2);(8*n).toFixed(2),a(n)}()},n.onerror=function(e,t){console.error("Invalid image, or error downloading")};var c="?nnn="+(e=(new Date).getTime());n.src="https://upload.wikimedia.org/wikipedia/commons/b/b9/Pizigani_1367_Chart_1MB.jpg"+c}window.addEventListener?window.addEventListener("load",e,!1):window.attachEvent&&window.attachEvent("onload",e)}(),me?Object(T.jsx)(de,{code:me,speed:n}):Object(T.jsx)(je,{})]})},ge=function(){return Object(T.jsx)(s.a,{children:Object(T.jsx)(o.c,{children:Object(T.jsx)(o.a,{path:"/",component:Oe,exact:!0})})})};i.a.render(Object(T.jsx)(a.a.StrictMode,{children:Object(T.jsx)(ge,{})}),document.getElementById("root"))},56:function(e,t,n){}},[[153,1,2]]]);
//# sourceMappingURL=main.6e92249c.chunk.js.map